<?php
/**
* @package   s9e\TextFormatter
* @copyright Copyright (c) 2010-2014 The s9e Authors
* @license   http://www.opensource.org/licenses/mit-license.php The MIT License
*/

namespace s9e\TextFormatter\Bundles\MediaPack;

class Renderer extends \s9e\TextFormatter\Renderer
{
	protected $htmlOutput=true;
	protected $params=['AMAZON_ASSOCIATE_TAG'=>''];
	protected static $tagBranches=['ABCNEWS'=>0,'AMAZON'=>1,'AUDIOMACK'=>2,'BANDCAMP'=>3,'BLIP'=>4,'BREAK'=>5,'CBSNEWS'=>6,'CNBC'=>7,'CNN'=>8,'CNNMONEY'=>9,'COLBERTNATION'=>10,'COMEDYCENTRAL'=>10,'DAILYSHOW'=>10,'GAMETRAILERS'=>10,'COLLEGEHUMOR'=>11,'COUB'=>12,'DAILYMOTION'=>13,'EBAY'=>14,'EIGHTTRACKS'=>15,'ESPN'=>16,'FACEBOOK'=>17,'FOXNEWS'=>18,'FUNNYORDIE'=>19,'GAMESPOT'=>20,'GETTY'=>21,'GFYCAT'=>22,'GIST'=>23,'GOOGLEPLUS'=>24,'GOOGLESHEETS'=>25,'GROOVESHARK'=>26,'HULU'=>27,'IGN'=>28,'IMDB'=>29,'IMGUR'=>30,'INDIEGOGO'=>31,'INSTAGRAM'=>32,'INTERNETARCHIVE'=>33,'IZLESENE'=>34,'KICKSTARTER'=>35,'LIVELEAK'=>36,'METACAFE'=>37,'MIXCLOUD'=>38,'MSNBC'=>39,'NYTIMES'=>40,'PASTEBIN'=>41,'PODBEAN'=>42,'PREZI'=>43,'RDIO'=>44,'RUTUBE'=>45,'SCRIBD'=>46,'SLIDESHARE'=>47,'SOUNDCLOUD'=>48,'SPOTIFY'=>49,'STRAWPOLL'=>50,'TEAMCOCO'=>51,'TED'=>52,'THEATLANTIC'=>53,'THEONION'=>54,'TINYPIC'=>55,'TRAILERADDICT'=>56,'TWITCH'=>57,'TWITTER'=>58,'USTREAM'=>59,'VEVO'=>60,'VIAGAME'=>61,'VIMEO'=>62,'VINE'=>63,'VK'=>64,'VOCAROO'=>65,'VUBE'=>66,'WSHH'=>67,'WSJ'=>68,'YAHOOSCREEN'=>69,'YOUKU'=>70,'YOUTUBE'=>71,'br'=>72,'e'=>73,'i'=>73,'s'=>73,'p'=>74];
	public function __sleep()
	{
		$props = get_object_vars($this);
		unset($props['out'], $props['proc'], $props['source']);
		return array_keys($props);
	}
	public function renderRichText($xml)
	{
		if (!isset(self::$quickRenderingTest) || !preg_match(self::$quickRenderingTest, $xml))
			try
			{
				return $this->renderQuick($xml);
			}
			catch (\Exception $e)
			{
			}
		$dom = $this->loadXML($xml);
		$this->out = '';
		$this->at($dom->documentElement);
		return $this->out;
	}
	protected function at(\DOMNode $root)
	{
		if ($root->nodeType === 3)
			$this->out .= htmlspecialchars($root->textContent,0);
		else
			foreach ($root->childNodes as $node)
				if (!isset(self::$tagBranches[$node->nodeName]))
					$this->at($node);
				else
				{
					$tb = self::$tagBranches[$node->nodeName];
					if($tb<38)if($tb<19)if($tb<10)if($tb<5)if($tb<3){if($tb===0)$this->out.='<iframe width="640" height="360" src="//abcnews.go.com/video/embed?id='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===1){$this->out.='<iframe width="120" height="240" allowfullscreen="" frameborder="0" scrolling="no" src="//rcm';if($node->hasAttribute('tld')&&(strpos('cadefritjpuk',$node->getAttribute('tld'))!==false))$this->out.='-'.htmlspecialchars($node->getAttribute('tld'),2);$this->out.='.amazon.';if($node->getAttribute('tld')==='jp'||$node->getAttribute('tld')==='uk')$this->out.='co.'.htmlspecialchars($node->getAttribute('tld'),2);elseif($node->hasAttribute('tld')&&(strpos('cadefrit',$node->getAttribute('tld'))!==false))$this->out.=htmlspecialchars($node->getAttribute('tld'),2);else$this->out.='com';$this->out.='/e/cm?lt1=_blank&amp;bc1=FFFFFF&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;p=8&amp;l=as1&amp;f=ifr&amp;asins='.htmlspecialchars($node->getAttribute('id'),2).'&amp;o=';if($node->getAttribute('tld')==='ca')$this->out.='15';elseif($node->getAttribute('tld')==='de')$this->out.='3';elseif($node->getAttribute('tld')==='fr')$this->out.='8';elseif($node->getAttribute('tld')==='it')$this->out.='29';elseif($node->getAttribute('tld')==='jp')$this->out.='9';elseif($node->getAttribute('tld')==='uk')$this->out.='2';else$this->out.='1';$this->out.='&amp;t=';if(!empty($this->params['AMAZON_ASSOCIATE_TAG']))$this->out.=htmlspecialchars($this->params['AMAZON_ASSOCIATE_TAG'],2);else$this->out.='_';$this->out.='"></iframe>';}else{$this->out.='<iframe width="100%" style="max-width:900px" allowfullscreen="" frameborder="0" scrolling="no" height="';if($node->getAttribute('mode')==='album')$this->out.='352';else$this->out.='144';$this->out.='" src="//www.audiomack.com/embed3';if($node->getAttribute('mode')==='album')$this->out.='-album';$this->out.='/'.htmlspecialchars($node->getAttribute('id'),2).'"></iframe>';}}elseif($tb===3){$this->out.='<iframe width="400" height="400" allowfullscreen="" frameborder="0" scrolling="no" src="//bandcamp.com/EmbeddedPlayer/size=large/minimal=true/';if($node->hasAttribute('album_id')){$this->out.='album='.htmlspecialchars($node->getAttribute('album_id'),2);if($node->hasAttribute('track_num'))$this->out.='/t='.htmlspecialchars($node->getAttribute('track_num'),2);}else$this->out.='track='.htmlspecialchars($node->getAttribute('track_id'),2);$this->out.='"></iframe>';}else$this->out.='<iframe width="560" height="315" src="//blip.tv/play/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<8)if($tb===5)$this->out.='<iframe width="464" height="280" src="//break.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===6){$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="425" height="279" data="';if($node->hasAttribute('pid'))$this->out.='http://www.cbsnews.com/common/video/cbsnews_player.swf';else$this->out.='http://i.i.cbsi.com/cnwk.1d/av/video/cbsnews/atlantis2/cbsnews_player_embed.swf';$this->out.='"><param name="allowfullscreen" value="true"><param name="flashvars" value="';if($node->hasAttribute('pid'))$this->out.='pType=embed&amp;si=254&amp;pid='.htmlspecialchars($node->getAttribute('pid'),2);else$this->out.='si=254&amp;contentValue='.htmlspecialchars($node->getAttribute('id'),2);$this->out.='"><embed type="application/x-shockwave-flash" width="425" height="279" allowfullscreen="" src="';if($node->hasAttribute('pid'))$this->out.='http://www.cbsnews.com/common/video/cbsnews_player.swf';else$this->out.='http://i.i.cbsi.com/cnwk.1d/av/video/cbsnews/atlantis2/cbsnews_player_embed.swf';$this->out.='" flashvars="';if($node->hasAttribute('pid'))$this->out.='pType=embed&amp;si=254&amp;pid='.htmlspecialchars($node->getAttribute('pid'),2);else$this->out.='si=254&amp;contentValue='.htmlspecialchars($node->getAttribute('id'),2);$this->out.='"></object>';}else$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="400" height="380" data="//plus.cnbc.com/rssvideosearch/action/player/id/'.htmlspecialchars($node->getAttribute('id'),2).'/code/cnbcplayershare"><param name="allowfullscreen" value="true"><embed type="application/x-shockwave-flash" src="//plus.cnbc.com/rssvideosearch/action/player/id/'.htmlspecialchars($node->getAttribute('id'),2).'/code/cnbcplayershare" width="400" height="380" allowfullscreen=""></object>';elseif($tb===8)$this->out.='<iframe width="560" height="315" src="http://edition.cnn.com/.element/widget/video/videoapi/html/embed.html#/video/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="560" height="360" src="http://money.cnn.com/.element/ssi/video/7.0/players/embed.player.html?videoid=video/'.htmlspecialchars($node->getAttribute('id'),2).'&amp;width=560&amp;height=360" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<15){if($tb<13)if($tb===10)$this->out.='<iframe width="512" height="288" src="//media.mtvnservices.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===11)$this->out.='<iframe width="600" height="369" src="//www.collegehumor.com/e/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="560" height="315" src="//coub.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===13)$this->out.='<iframe width="560" height="315" src="//www.dailymotion.com/embed/video/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else{$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="355" height="300" data="http://togo.ebay.com/togo/togo.swf?2008013100"><param name="allowfullscreen" value="true"><param name="flashvars" value="base=http://togo.ebay.com/togo/&amp;mode=normal&amp;itemid=';if($node->hasAttribute('itemid'))$this->out.=htmlspecialchars($node->getAttribute('itemid'),2);else$this->out.=htmlspecialchars($node->getAttribute('id'),2);if($node->hasAttribute('lang'))$this->out.='&amp;lang='.htmlspecialchars(strtr($node->getAttribute('lang'),'_','-'),2);$this->out.='"><embed type="application/x-shockwave-flash" src="http://togo.ebay.com/togo/togo.swf?2008013100" width="355" height="300" allowfullscreen="" flashvars="base=http://togo.ebay.com/togo/&amp;mode=normal&amp;itemid=';if($node->hasAttribute('itemid'))$this->out.=htmlspecialchars($node->getAttribute('itemid'),2);else$this->out.=htmlspecialchars($node->getAttribute('id'),2);if($node->hasAttribute('lang'))$this->out.='&amp;lang='.htmlspecialchars(strtr($node->getAttribute('lang'),'_','-'),2);$this->out.='"></object>';}}elseif($tb===15)$this->out.='<iframe width="400" height="400" src="//8tracks.com/mixes/'.htmlspecialchars($node->getAttribute('id'),2).'/player_v3_universal" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===16)$this->out.='<iframe width="560" height="315" src="https://espn.go.com/video/iframe/twitter/?cms='.htmlspecialchars($node->getAttribute('cms'),2).'&amp;id='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===17)$this->out.='<iframe width="560" height="315" src="//s9e.github.io/iframe/facebook.min.html#'.htmlspecialchars($node->getAttribute('id'),2).'" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="560" height="315" src="//video.foxnews.com/v/video-embed.html?video_id='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<29)if($tb<24)if($tb<22)if($tb===19)$this->out.='<iframe width="640" height="360" src="http://www.funnyordie.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===20)$this->out.='<iframe width="640" height="400" src="//www.gamespot.com/videos/embed/'.htmlspecialchars($node->getAttribute('id'),2).'/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="'.htmlspecialchars($node->getAttribute('width'),2).'" height="'.htmlspecialchars(49+$node->getAttribute('height'),2).'" src="//embed.gettyimages.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'?et='.htmlspecialchars($node->getAttribute('et'),2).'&amp;sig='.htmlspecialchars($node->getAttribute('sig'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===22)$this->out.='<iframe width="'.htmlspecialchars($node->getAttribute('width'),2).'" height="'.htmlspecialchars($node->getAttribute('height'),2).'" src="//gfycat.com/iframe/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe style="width:100%" src="//s9e.github.io/iframe/gist.min.html#'.htmlspecialchars($node->getAttribute('id'),2).'" frameborder="0" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))"></iframe>';elseif($tb<27)if($tb===24)$this->out.='<iframe width="450" height="240" src="//s9e.github.io/iframe/googleplus.min.html#'.htmlspecialchars($node->getAttribute('oid'),2).'/posts/'.htmlspecialchars($node->getAttribute('pid'),2).'" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===25)$this->out.='<iframe width="100%" height="500" style="resize:both" src="https://docs.google.com/spreadsheet/ccc?key='.htmlspecialchars($node->getAttribute('id'),2).'&amp;widget=true&amp;headers=false&amp;rm=minimal#gid='.htmlspecialchars($node->getAttribute('gid'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="400" height="'.htmlspecialchars(($node->hasAttribute('songid')?40:400),2).'" data="//grooveshark.com/'.htmlspecialchars(($node->hasAttribute('songid')?'songW':'w'),2).'idget.swf"><param name="allowfullscreen" value="true"><param name="flashvars" value="playlistID='.htmlspecialchars($node->getAttribute('playlistid'),2).'&amp;songID='.htmlspecialchars($node->getAttribute('songid'),2).'"><embed type="application/x-shockwave-flash" src="//grooveshark.com/'.htmlspecialchars(($node->hasAttribute('songid')?'songW':'w'),2).'idget.swf" width="400" height="'.htmlspecialchars(($node->hasAttribute('songid')?40:400),2).'" allowfullscreen="" flashvars="playlistID='.htmlspecialchars($node->getAttribute('playlistid'),2).'&amp;songID='.htmlspecialchars($node->getAttribute('songid'),2).'"></object>';elseif($tb===27)$this->out.='<iframe width="640" height="360" src="https://secure.hulu.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="468" height="263" src="http://widgets.ign.com/video/embed/content.html?url='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<34)if($tb<32)if($tb===29)$this->out.='<iframe width="560" height="315" src="http://www.imdb.com/video/imdb/vi'.htmlspecialchars($node->getAttribute('id'),2).'/imdb/embed?autoplay=false&amp;width=560" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===30)$this->out.='<iframe width="100%" height="550" src="//imgur.com/a/'.htmlspecialchars($node->getAttribute('id'),2).'/embed" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="224" height="486" src="//www.indiegogo.com/project/'.htmlspecialchars($node->getAttribute('id'),2).'/widget" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===32)$this->out.='<iframe width="612" height="710" src="//instagram.com/p/'.htmlspecialchars($node->getAttribute('id'),2).'/embed/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="'.htmlspecialchars($node->getAttribute('width'),2).'" height="'.htmlspecialchars($node->getAttribute('height'),2).'" src="https://archive.org/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===34)$this->out.='<iframe width="560" height="315" src="//www.izlesene.com/embedplayer/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===35)if($node->hasAttribute('video'))$this->out.='<iframe width="480" height="360" src="//www.kickstarter.com/projects/'.htmlspecialchars($node->getAttribute('id'),2).'/widget/video.html" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="220" height="380" src="//www.kickstarter.com/projects/'.htmlspecialchars($node->getAttribute('id'),2).'/widget/card.html" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===36)$this->out.='<iframe width="640" height="360" src="http://www.liveleak.com/ll_embed?i='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="560" height="315" src="//www.metacafe.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<57)if($tb<48)if($tb<43)if($tb<41)if($tb===38)$this->out.='<iframe width="400" height="400" src="//www.mixcloud.com/widget/iframe/?feed=http%3A%2F%2Fwww.mixcloud.com%2F'.htmlspecialchars($node->getAttribute('id'),2).'%2F&amp;embed_type=widget_standard" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===39)$this->out.='<iframe width="635" height="440" src="//player.theplatform.com/p/2E2eJC/EmbeddedOffSite?guid='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="480" height="373" src="http://graphics8.nytimes.com/bcvideo/1.0/iframe/embed.html?videoId='.htmlspecialchars($node->getAttribute('id'),2).'&amp;playerType=embed" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===41)$this->out.='<iframe width="100%" height="300" src="//pastebin.com/embed_iframe.php?i='.htmlspecialchars($node->getAttribute('id'),2).'" scrolling="" style="resize:both" allowfullscreen="" frameborder="0"></iframe>';else$this->out.='<iframe width="100%" height="100" style="max-width:900px" src="http://www.podbean.com/media/player/audio/postId/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<46)if($tb===43)$this->out.='<iframe width="550" height="400" src="//prezi.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===44)$this->out.='<iframe width="400" height="400" src="https://rd.io/i/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="720" height="405" src="//rutube.ru/play/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===46)$this->out.='<iframe width="100%" height="500" style="resize:both" src="//www.scribd.com/embeds/'.htmlspecialchars($node->getAttribute('id'),2).'/content?view_mode=scroll&amp;show_recommendations=false" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="427" height="356" src="//www.slideshare.net/slideshow/embed_code/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<53){if($tb<51)if($tb===48){$this->out.='<iframe width="100%" height="166" style="max-width:900px" allowfullscreen="" frameborder="0" scrolling="no" src="https://w.soundcloud.com/player/?url=';if($node->hasAttribute('secret_token')&&$node->hasAttribute('playlist_id'))$this->out.='https://api.soundcloud.com/playlists/'.htmlspecialchars($node->getAttribute('playlist_id'),2).'&amp;secret_token='.htmlspecialchars($node->getAttribute('secret_token'),2);elseif($node->hasAttribute('secret_token')&&$node->hasAttribute('track_id'))$this->out.='https://api.soundcloud.com/tracks/'.htmlspecialchars($node->getAttribute('track_id'),2).'&amp;secret_token='.htmlspecialchars($node->getAttribute('secret_token'),2);else{if((strpos($node->getAttribute('id'),'://')===false))$this->out.='https://soundcloud.com/';$this->out.=htmlspecialchars($node->getAttribute('id'),2);if($node->hasAttribute('secret_token'))$this->out.='&amp;secret_token='.htmlspecialchars($node->getAttribute('secret_token'),2);}$this->out.='"></iframe>';}elseif($tb===49){$this->out.='<iframe width="400" height="480" allowfullscreen="" frameborder="0" scrolling="no" src="https://embed.spotify.com/?view=coverart&amp;uri=';if($node->hasAttribute('uri'))$this->out.=htmlspecialchars($node->getAttribute('uri'),2);else$this->out.='spotify:'.htmlspecialchars(strtr($node->getAttribute('path'),'/',':'),2);$this->out.='"></iframe>';}else$this->out.='<iframe width="600" height="310" src="http://strawpoll.me/embed_1/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===51)$this->out.='<iframe width="640" height="415" src="//teamcoco.com/embed/v/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else{$this->out.='<iframe width="560" height="315" allowfullscreen="" frameborder="0" scrolling="no" src="http://embed.ted.com/'.htmlspecialchars($node->getAttribute('id'),2);if((strpos($node->getAttribute('id'),'.html')===false))$this->out.='.html';$this->out.='"></iframe>';}}elseif($tb===53)$this->out.='<iframe width="640" height="360" src="http://www.theatlantic.com/video/iframe/'.htmlspecialchars($node->getAttribute('id'),2).'/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===54)$this->out.='<iframe width="560" height="315" src="http://www.theonion.com/video_embed/?id='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===55)$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="560" height="345" data="http://tinypic.com/player.swf?file='.htmlspecialchars($node->getAttribute('id'),2).'&amp;s='.htmlspecialchars($node->getAttribute('s'),2).'"><param name="allowfullscreen" value="true"><embed type="application/x-shockwave-flash" src="http://tinypic.com/player.swf?file='.htmlspecialchars($node->getAttribute('id'),2).'&amp;s='.htmlspecialchars($node->getAttribute('s'),2).'" width="560" height="345" allowfullscreen=""></object>';else$this->out.='<iframe width="560" height="315" src="//v.traileraddict.com/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb<66)if($tb<62)if($tb<60)if($tb===57){$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="620" height="378" data="//www.twitch.tv/widgets/';if($node->hasAttribute('archive_id')||$node->hasAttribute('chapter_id'))$this->out.='arch';else$this->out.='l';$this->out.='ive_embed_player.swf"><param name="allowfullscreen" value="true"><param name="flashvars" value="channel='.htmlspecialchars($node->getAttribute('channel'),2);if($node->hasAttribute('archive_id'))$this->out.='&amp;archive_id='.htmlspecialchars($node->getAttribute('archive_id'),2);if($node->hasAttribute('chapter_id'))$this->out.='&amp;chapter_id='.htmlspecialchars($node->getAttribute('chapter_id'),2);$this->out.='&amp;auto_play=false"><embed type="application/x-shockwave-flash" width="620" height="378" allowfullscreen="" src="//www.twitch.tv/widgets/';if($node->hasAttribute('archive_id')||$node->hasAttribute('chapter_id'))$this->out.='arch';else$this->out.='l';$this->out.='ive_embed_player.swf" flashvars="channel='.htmlspecialchars($node->getAttribute('channel'),2);if($node->hasAttribute('archive_id'))$this->out.='&amp;archive_id='.htmlspecialchars($node->getAttribute('archive_id'),2);if($node->hasAttribute('chapter_id'))$this->out.='&amp;chapter_id='.htmlspecialchars($node->getAttribute('chapter_id'),2);$this->out.='&amp;auto_play=false"></object>';}elseif($tb===58)$this->out.='<iframe width="500" height="186" src="//s9e.github.io/iframe/twitter.min.html#'.htmlspecialchars($node->getAttribute('id'),2).'" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else{$this->out.='<iframe width="480" height="302" allowfullscreen="" frameborder="0" scrolling="no" src="//www.ustream.tv/embed/';if($node->hasAttribute('vid'))$this->out.='recorded/'.htmlspecialchars($node->getAttribute('vid'),2);else$this->out.=htmlspecialchars($node->getAttribute('cid'),2);$this->out.='"></iframe>';}elseif($tb===60)$this->out.='<iframe width="575" height="324" src="http://cache.vevo.com/m/html/embed.html?video='.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="640" height="392" src="//www.viagame.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===62)$this->out.='<iframe width="560" height="315" src="//player.vimeo.com/video/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===63)$this->out.='<iframe width="480" height="480" src="https://vine.co/v/'.htmlspecialchars($node->getAttribute('id'),2).'/embed/simple" allowfullscreen="" frameborder="0" scrolling="no"></iframe><script async="" src="//platform.vine.co/static/scripts/embed.js" charset="utf-8"></script>';elseif($tb===64)$this->out.='<iframe width="607" height="360" src="//vk.com/video_ext.php?oid='.htmlspecialchars($node->getAttribute('oid'),2).'&amp;id='.htmlspecialchars($node->getAttribute('vid'),2).'&amp;hash='.htmlspecialchars($node->getAttribute('hash'),2).'&amp;hd=1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<object type="application/x-shockwave-flash" typemustmatch="" width="148" height="44" data="//vocaroo.com/player.swf?playMediaID='.htmlspecialchars($node->getAttribute('id'),2).'&amp;autoplay=0"><param name="allowfullscreen" value="true"><embed type="application/x-shockwave-flash" src="//vocaroo.com/player.swf?playMediaID='.htmlspecialchars($node->getAttribute('id'),2).'&amp;autoplay=0" width="148" height="44" allowfullscreen=""></object>';elseif($tb<71)if($tb<69)if($tb===66)$this->out.='<iframe width="640" height="435" src="//vube.com/embed/video/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===67)$this->out.='<iframe width="640" height="360" src="//www.worldstarhiphop.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="512" height="288" src="http://live.wsj.com/public/page/embed-'.htmlspecialchars(strtr($node->getAttribute('id'),'-','_'),2).'.html" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===69)$this->out.='<iframe width="640" height="360" src="https://screen.yahoo.com/'.htmlspecialchars($node->getAttribute('id'),2).'.html?format=embed" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$this->out.='<iframe width="512" height="328" src="http://player.youku.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';elseif($tb===71){$this->out.='<iframe width="560" height="315" allowfullscreen="" frameborder="0" scrolling="no" src="//www.youtube.com/embed/'.htmlspecialchars($node->getAttribute('id'),2).'?controls=2';if($node->hasAttribute('list'))$this->out.='&amp;list='.htmlspecialchars($node->getAttribute('list'),2);if($node->hasAttribute('t')||$node->hasAttribute('m')){$this->out.='&amp;start=';if($node->hasAttribute('t'))$this->out.=htmlspecialchars($node->getAttribute('t'),2);elseif($node->hasAttribute('h'))$this->out.=htmlspecialchars($node->getAttribute('h')*3600+$node->getAttribute('m')*60+$node->getAttribute('s'),2);else$this->out.=htmlspecialchars($node->getAttribute('m')*60+$node->getAttribute('s'),2);}$this->out.='"></iframe>';}elseif($tb===72)$this->out.='<br>';elseif($tb===73);else{$this->out.='<p>';$this->at($node);$this->out.='</p>';}
				}
	}
	private static $dynamic=['ABCNEWS'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="//abcnews.go.com/video/embed?id=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'BLIP'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//blip.tv/play/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'BREAK'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="464" height="280" src="//break.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'CNBC'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<object type="application/x-shockwave-flash" typemustmatch="" width="400" height="380" data="//plus.cnbc.com/rssvideosearch/action/player/id/$1/code/cnbcplayershare"><param name="allowfullscreen" value="true"><embed type="application/x-shockwave-flash" src="//plus.cnbc.com/rssvideosearch/action/player/id/$1/code/cnbcplayershare" width="400" height="380" allowfullscreen=""></object>'],'CNN'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="http://edition.cnn.com/.element/widget/video/videoapi/html/embed.html#/video/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'CNNMONEY'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="360" src="http://money.cnn.com/.element/ssi/video/7.0/players/embed.player.html?videoid=video/$1&amp;width=560&amp;height=360" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'COLBERTNATION'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="512" height="288" src="//media.mtvnservices.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'COLLEGEHUMOR'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="600" height="369" src="//www.collegehumor.com/e/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'COMEDYCENTRAL'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="512" height="288" src="//media.mtvnservices.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'COUB'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//coub.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'DAILYMOTION'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//www.dailymotion.com/embed/video/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'DAILYSHOW'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="512" height="288" src="//media.mtvnservices.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'EIGHTTRACKS'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="400" height="400" src="//8tracks.com/mixes/$1/player_v3_universal" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'ESPN'=>['(^\\S*(?> (?!(?>cms|id)=)[^=]+="[^"]*")*(?> cms="([^"]+)")?(?> (?!(?>cms|id)=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="https://espn.go.com/video/iframe/twitter/?cms=$1&amp;id=$2" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'FACEBOOK'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//s9e.github.io/iframe/facebook.min.html#$1" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'FOXNEWS'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//video.foxnews.com/v/video-embed.html?video_id=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'FUNNYORDIE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="http://www.funnyordie.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'GAMESPOT'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="400" src="//www.gamespot.com/videos/embed/$1/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'GAMETRAILERS'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="512" height="288" src="//media.mtvnservices.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'GFYCAT'=>['(^\\S*(?> (?!(?>height|id|width)=)[^=]+="[^"]*")*(?> height="([^"]+)")?(?> (?!(?>height|id|width)=)[^=]+="[^"]*")*(?> id="([^"]+)")?(?> (?!(?>height|id|width)=)[^=]+="[^"]*")*(?> width="([^"]+)")?.*)s','<iframe width="$3" height="$1" src="//gfycat.com/iframe/$2" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'GIST'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe style="width:100%" src="//s9e.github.io/iframe/gist.min.html#$1" frameborder="0" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))"></iframe>'],'GOOGLEPLUS'=>['(^\\S*(?> (?![op]id=)[^=]+="[^"]*")*(?> oid="([^"]+)")?(?> (?![op]id=)[^=]+="[^"]*")*(?> pid="([^"]+)")?.*)s','<iframe width="450" height="240" src="//s9e.github.io/iframe/googleplus.min.html#$1/posts/$2" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'GOOGLESHEETS'=>['(^\\S*(?> (?!g?id=)[^=]+="[^"]*")*(?> gid="([^"]+)")?(?> (?!g?id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="100%" height="500" style="resize:both" src="https://docs.google.com/spreadsheet/ccc?key=$2&amp;widget=true&amp;headers=false&amp;rm=minimal#gid=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'HULU'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="https://secure.hulu.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'IGN'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="468" height="263" src="http://widgets.ign.com/video/embed/content.html?url=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'IMDB'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="http://www.imdb.com/video/imdb/vi$1/imdb/embed?autoplay=false&amp;width=560" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'IMGUR'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="100%" height="550" src="//imgur.com/a/$1/embed" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'INDIEGOGO'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="224" height="486" src="//www.indiegogo.com/project/$1/widget" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'INSTAGRAM'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="612" height="710" src="//instagram.com/p/$1/embed/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'INTERNETARCHIVE'=>['(^\\S*(?> (?!(?>height|id|width)=)[^=]+="[^"]*")*(?> height="([^"]+)")?(?> (?!(?>height|id|width)=)[^=]+="[^"]*")*(?> id="([^"]+)")?(?> (?!(?>height|id|width)=)[^=]+="[^"]*")*(?> width="([^"]+)")?.*)s','<iframe width="$3" height="$1" src="https://archive.org/embed/$2" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'IZLESENE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//www.izlesene.com/embedplayer/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'LIVELEAK'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="http://www.liveleak.com/ll_embed?i=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'METACAFE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//www.metacafe.com/embed/$1/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'MIXCLOUD'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="400" height="400" src="//www.mixcloud.com/widget/iframe/?feed=http%3A%2F%2Fwww.mixcloud.com%2F$1%2F&amp;embed_type=widget_standard" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'MSNBC'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="635" height="440" src="//player.theplatform.com/p/2E2eJC/EmbeddedOffSite?guid=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'NYTIMES'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="480" height="373" src="http://graphics8.nytimes.com/bcvideo/1.0/iframe/embed.html?videoId=$1&amp;playerType=embed" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'PASTEBIN'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="100%" height="300" src="//pastebin.com/embed_iframe.php?i=$1" scrolling="" style="resize:both" allowfullscreen="" frameborder="0"></iframe>'],'PODBEAN'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="100%" height="100" style="max-width:900px" src="http://www.podbean.com/media/player/audio/postId/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'PREZI'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="550" height="400" src="//prezi.com/embed/$1/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'RDIO'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="400" height="400" src="https://rd.io/i/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'RUTUBE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="720" height="405" src="//rutube.ru/play/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'SCRIBD'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="100%" height="500" style="resize:both" src="//www.scribd.com/embeds/$1/content?view_mode=scroll&amp;show_recommendations=false" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'SLIDESHARE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="427" height="356" src="//www.slideshare.net/slideshow/embed_code/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'STRAWPOLL'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="600" height="310" src="http://strawpoll.me/embed_1/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'TEAMCOCO'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="415" src="//teamcoco.com/embed/v/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'THEATLANTIC'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="http://www.theatlantic.com/video/iframe/$1/" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'THEONION'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="http://www.theonion.com/video_embed/?id=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'TINYPIC'=>['(^\\S*(?> (?!(?>s|id)=)[^=]+="[^"]*")*(?> id="([^"]+)")?(?> (?!(?>s|id)=)[^=]+="[^"]*")*(?> s="([^"]+)")?.*)s','<object type="application/x-shockwave-flash" typemustmatch="" width="560" height="345" data="http://tinypic.com/player.swf?file=$1&amp;s=$2"><param name="allowfullscreen" value="true"><embed type="application/x-shockwave-flash" src="http://tinypic.com/player.swf?file=$1&amp;s=$2" width="560" height="345" allowfullscreen=""></object>'],'TRAILERADDICT'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//v.traileraddict.com/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'TWITTER'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="500" height="186" src="//s9e.github.io/iframe/twitter.min.html#$1" onload="var a=Math.random();window.addEventListener(\'message\',function(b){if(b.data.id==a)style.height=b.data.height+\'px\'});contentWindow.postMessage(\'s9e:\'+a,src.substr(0,src.indexOf(\'/\',8)))" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'VEVO'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="575" height="324" src="http://cache.vevo.com/m/html/embed.html?video=$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'VIAGAME'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="392" src="//www.viagame.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'VIMEO'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="560" height="315" src="//player.vimeo.com/video/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'VINE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="480" height="480" src="https://vine.co/v/$1/embed/simple" allowfullscreen="" frameborder="0" scrolling="no"></iframe><script async="" src="//platform.vine.co/static/scripts/embed.js" charset="utf-8"></script>'],'VK'=>['(^\\S*(?> (?!(?>hash|oid|vid)=)[^=]+="[^"]*")*(?> hash="([^"]+)")?(?> (?!(?>hash|oid|vid)=)[^=]+="[^"]*")*(?> oid="([^"]+)")?(?> (?!(?>hash|oid|vid)=)[^=]+="[^"]*")*(?> vid="([^"]+)")?.*)s','<iframe width="607" height="360" src="//vk.com/video_ext.php?oid=$2&amp;id=$3&amp;hash=$1&amp;hd=1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'VOCAROO'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<object type="application/x-shockwave-flash" typemustmatch="" width="148" height="44" data="//vocaroo.com/player.swf?playMediaID=$1&amp;autoplay=0"><param name="allowfullscreen" value="true"><embed type="application/x-shockwave-flash" src="//vocaroo.com/player.swf?playMediaID=$1&amp;autoplay=0" width="148" height="44" allowfullscreen=""></object>'],'VUBE'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="435" src="//vube.com/embed/video/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'WSHH'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="//www.worldstarhiphop.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'YAHOOSCREEN'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="640" height="360" src="https://screen.yahoo.com/$1.html?format=embed" allowfullscreen="" frameborder="0" scrolling="no"></iframe>'],'YOUKU'=>['(^\\S*(?> (?!id=)[^=]+="[^"]*")*(?> id="([^"]+)")?.*)s','<iframe width="512" height="328" src="http://player.youku.com/embed/$1" allowfullscreen="" frameborder="0" scrolling="no"></iframe>']];
	private static $attributes;
	private static $quickBranches=['AMAZON'=>0,'AUDIOMACK'=>1,'BANDCAMP'=>2,'CBSNEWS'=>3,'EBAY'=>4,'GETTY'=>5,'GROOVESHARK'=>6,'KICKSTARTER'=>7,'SOUNDCLOUD'=>8,'SPOTIFY'=>9,'TED'=>10,'TWITCH'=>11,'USTREAM'=>12,'WSJ'=>13,'YOUTUBE'=>14];

	protected function renderQuick($xml)
	{
		self::$attributes = [];
		$html = preg_replace_callback(
			'(<(?:((?:A(?>BCNEWS|MAZON|UDIOMACK)|B(?>ANDCAMP|LIP|REAK)|C(?:BSNEWS|N(?:BC|N(?>MONEY)?)|O(?>L(?>BERTNATION|LEGEHUMOR)|MEDYCENTRAL|UB))|DAILY(?>MOTION|SHOW)|E(?>BAY|IGHTTRACKS|SPN)|F(?>ACEBOOK|OXNEWS|UNNYORDIE)|G(?>AME(?>SPOT|TRAILERS)|ETTY|FYCAT|IST|OOGLE(?>PLU|SHEET)S|ROOVESHARK)|HULU|I(?>GN|M(?>DB|GUR)|N(?>DIEGOGO|STAGRAM|TERNETARCHIVE)|ZLESENE)|KICKSTARTER|LIVELEAK|M(?>ETACAFE|IXCLOUD|SNBC)|NYTIMES|P(?>ASTEBIN|ODBEAN|REZI)|R(?>DIO|UTUBE)|S(?>CRIBD|LIDESHARE|OUNDCLOUD|POTIFY|TRAWPOLL)|T(?>E(?>D|AMCOCO)|HE(?>ATLANTIC|ONION)|INYPIC|RAILERADDICT|WIT(?>CH|TER))|USTREAM|V(?>K|EVO|I(?>AGAME|MEO|NE)|OCAROO|UBE)|WS(?>J|HH)|Y(?>AHOOSCREEN|OU(?>KU|TUBE))))(?: [^>]*)?(?:/|>.*?</\\1)|(/?(?!br/|p>)[^ />]+)[^>]*)>)',
			[$this, 'quick'],
			preg_replace(
				'(<[eis]>[^<]*</[eis]>)',
				'',
				substr($xml, 1 + strpos($xml, '>'), -4)
			)
		);

		return str_replace('<br/>', '<br>', $html);
	}

	protected function quick($m)
	{
		if (isset($m[2]))
		{
			$id = $m[2];

			if (substr($m[0], -2, 1) === '/')
			{
				$m[0] = substr($m[0], 0, -2) . '>';
				$html = $this->quick($m);

				$m[0] = '</' . $id . '>';
				$m[2] = '/' . $id;
				$html .= $this->quick($m);

				return $html;
			}
		}
		else
		{
			$id = $m[1];

			if (substr($m[0], -2, 1) === '/')
			{
				$m[0] = substr($m[0], 0, -2) . '></' . $id . '>';
				$m[1] = $id;
				unset($m[2]);

				return $this->quick($m);
			}

			$lpos = 1 + strpos($m[0], '>');
			$rpos = strrpos($m[0], '<');
			$textContent = substr($m[0], $lpos, $rpos - $lpos);

			if (strpos($textContent, '<') !== false)
				throw new \RuntimeException;

			$textContent = htmlspecialchars_decode($textContent);
		}

		if (isset(self::$dynamic[$id]))
		{
			list($match, $replace) = self::$dynamic[$id];
			$html = preg_replace($match, $replace, $m[0], 1, $cnt);
			if ($cnt)
				return $html;
		}

		if (!isset(self::$quickBranches[$id]))
			return '';

		if ($id[0] !== '/')
		{
			$attributes = [];
			preg_match_all('(([^ ]+)="([^"]+))', $m[0], $matches);
			foreach ($matches[1] as $i => $attrName)
				$attributes[$attrName] = $matches[2][$i];
		}

		$qb = self::$quickBranches[$id];
		if($qb<8)if($qb<4)if($qb===0){$attributes+=['tld'=>null,'id'=>null];$html='<iframe width="120" height="240" allowfullscreen="" frameborder="0" scrolling="no" src="//rcm';if(isset($attributes['tld'])&&(strpos('cadefritjpuk',$attributes['tld'])!==false))$html.='-'.$attributes['tld'];$html.='.amazon.';if($attributes['tld']==='jp'||$attributes['tld']==='uk')$html.='co.'.$attributes['tld'];elseif(isset($attributes['tld'])&&(strpos('cadefrit',$attributes['tld'])!==false))$html.=$attributes['tld'];else$html.='com';$html.='/e/cm?lt1=_blank&amp;bc1=FFFFFF&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;p=8&amp;l=as1&amp;f=ifr&amp;asins='.$attributes['id'].'&amp;o=';if($attributes['tld']==='ca')$html.='15';elseif($attributes['tld']==='de')$html.='3';elseif($attributes['tld']==='fr')$html.='8';elseif($attributes['tld']==='it')$html.='29';elseif($attributes['tld']==='jp')$html.='9';elseif($attributes['tld']==='uk')$html.='2';else$html.='1';$html.='&amp;t=';if(!empty($this->params['AMAZON_ASSOCIATE_TAG']))$html.=htmlspecialchars($this->params['AMAZON_ASSOCIATE_TAG'],2);else$html.='_';$html.='"></iframe>';}elseif($qb===1){$attributes+=['mode'=>null,'id'=>null];$html='<iframe width="100%" style="max-width:900px" allowfullscreen="" frameborder="0" scrolling="no" height="';if($attributes['mode']==='album')$html.='352';else$html.='144';$html.='" src="//www.audiomack.com/embed3';if($attributes['mode']==='album')$html.='-album';$html.='/'.$attributes['id'].'"></iframe>';}elseif($qb===2){$attributes+=['track_num'=>null,'track_id'=>null];$html='<iframe width="400" height="400" allowfullscreen="" frameborder="0" scrolling="no" src="//bandcamp.com/EmbeddedPlayer/size=large/minimal=true/';if(isset($attributes['album_id'])){$html.='album='.$attributes['album_id'];if(isset($attributes['track_num']))$html.='/t='.$attributes['track_num'];}else$html.='track='.$attributes['track_id'];$html.='"></iframe>';}else{$attributes+=['id'=>null];$html='<object type="application/x-shockwave-flash" typemustmatch="" width="425" height="279" data="';if(isset($attributes['pid']))$html.='http://www.cbsnews.com/common/video/cbsnews_player.swf';else$html.='http://i.i.cbsi.com/cnwk.1d/av/video/cbsnews/atlantis2/cbsnews_player_embed.swf';$html.='"><param name="allowfullscreen" value="true"><param name="flashvars" value="';if(isset($attributes['pid']))$html.='pType=embed&amp;si=254&amp;pid='.$attributes['pid'];else$html.='si=254&amp;contentValue='.$attributes['id'];$html.='"><embed type="application/x-shockwave-flash" width="425" height="279" allowfullscreen="" src="';if(isset($attributes['pid']))$html.='http://www.cbsnews.com/common/video/cbsnews_player.swf';else$html.='http://i.i.cbsi.com/cnwk.1d/av/video/cbsnews/atlantis2/cbsnews_player_embed.swf';$html.='" flashvars="';if(isset($attributes['pid']))$html.='pType=embed&amp;si=254&amp;pid='.$attributes['pid'];else$html.='si=254&amp;contentValue='.$attributes['id'];$html.='"></object>';}elseif($qb===4){$attributes+=['id'=>null];$html='<object type="application/x-shockwave-flash" typemustmatch="" width="355" height="300" data="http://togo.ebay.com/togo/togo.swf?2008013100"><param name="allowfullscreen" value="true"><param name="flashvars" value="base=http://togo.ebay.com/togo/&amp;mode=normal&amp;itemid=';if(isset($attributes['itemid']))$html.=$attributes['itemid'];else$html.=$attributes['id'];if(isset($attributes['lang']))$html.='&amp;lang='.strtr($attributes['lang'],'_','-');$html.='"><embed type="application/x-shockwave-flash" src="http://togo.ebay.com/togo/togo.swf?2008013100" width="355" height="300" allowfullscreen="" flashvars="base=http://togo.ebay.com/togo/&amp;mode=normal&amp;itemid=';if(isset($attributes['itemid']))$html.=$attributes['itemid'];else$html.=$attributes['id'];if(isset($attributes['lang']))$html.='&amp;lang='.strtr($attributes['lang'],'_','-');$html.='"></object>';}elseif($qb===5){$attributes+=['width'=>null,'height'=>null,'id'=>null,'et'=>null,'sig'=>null];$html='<iframe width="'.$attributes['width'].'" height="'.htmlspecialchars(49+$attributes['height'],2).'" src="//embed.gettyimages.com/embed/'.$attributes['id'].'?et='.$attributes['et'].'&amp;sig='.$attributes['sig'].'" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';}elseif($qb===6){$attributes+=['playlistid'=>null,'songid'=>null];$html='<object type="application/x-shockwave-flash" typemustmatch="" width="400" height="'.htmlspecialchars((isset($attributes['songid'])?40:400),2).'" data="//grooveshark.com/'.htmlspecialchars((isset($attributes['songid'])?'songW':'w'),2).'idget.swf"><param name="allowfullscreen" value="true"><param name="flashvars" value="playlistID='.$attributes['playlistid'].'&amp;songID='.$attributes['songid'].'"><embed type="application/x-shockwave-flash" src="//grooveshark.com/'.htmlspecialchars((isset($attributes['songid'])?'songW':'w'),2).'idget.swf" width="400" height="'.htmlspecialchars((isset($attributes['songid'])?40:400),2).'" allowfullscreen="" flashvars="playlistID='.$attributes['playlistid'].'&amp;songID='.$attributes['songid'].'"></object>';}else{$attributes+=['id'=>null];$html='';if(isset($attributes['video']))$html.='<iframe width="480" height="360" src="//www.kickstarter.com/projects/'.$attributes['id'].'/widget/video.html" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';else$html.='<iframe width="220" height="380" src="//www.kickstarter.com/projects/'.$attributes['id'].'/widget/card.html" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';}elseif($qb<12){if($qb===8){$attributes+=['playlist_id'=>null,'track_id'=>null,'id'=>null];$html='<iframe width="100%" height="166" style="max-width:900px" allowfullscreen="" frameborder="0" scrolling="no" src="https://w.soundcloud.com/player/?url=';if(isset($attributes['secret_token'])&&isset($attributes['playlist_id']))$html.='https://api.soundcloud.com/playlists/'.$attributes['playlist_id'].'&amp;secret_token='.$attributes['secret_token'];elseif(isset($attributes['secret_token'])&&isset($attributes['track_id']))$html.='https://api.soundcloud.com/tracks/'.$attributes['track_id'].'&amp;secret_token='.$attributes['secret_token'];else{if((strpos($attributes['id'],'://')===false))$html.='https://soundcloud.com/';$html.=$attributes['id'];if(isset($attributes['secret_token']))$html.='&amp;secret_token='.$attributes['secret_token'];}$html.='"></iframe>';}elseif($qb===9){$attributes+=['path'=>null];$html='<iframe width="400" height="480" allowfullscreen="" frameborder="0" scrolling="no" src="https://embed.spotify.com/?view=coverart&amp;uri=';if(isset($attributes['uri']))$html.=$attributes['uri'];else$html.='spotify:'.strtr($attributes['path'],'/',':');$html.='"></iframe>';}elseif($qb===10){$attributes+=['id'=>null];$html='<iframe width="560" height="315" allowfullscreen="" frameborder="0" scrolling="no" src="http://embed.ted.com/'.$attributes['id'];if((strpos($attributes['id'],'.html')===false))$html.='.html';$html.='"></iframe>';}else{$attributes+=['channel'=>null];$html='<object type="application/x-shockwave-flash" typemustmatch="" width="620" height="378" data="//www.twitch.tv/widgets/';if(isset($attributes['archive_id'])||isset($attributes['chapter_id']))$html.='arch';else$html.='l';$html.='ive_embed_player.swf"><param name="allowfullscreen" value="true"><param name="flashvars" value="channel='.$attributes['channel'];if(isset($attributes['archive_id']))$html.='&amp;archive_id='.$attributes['archive_id'];if(isset($attributes['chapter_id']))$html.='&amp;chapter_id='.$attributes['chapter_id'];$html.='&amp;auto_play=false"><embed type="application/x-shockwave-flash" width="620" height="378" allowfullscreen="" src="//www.twitch.tv/widgets/';if(isset($attributes['archive_id'])||isset($attributes['chapter_id']))$html.='arch';else$html.='l';$html.='ive_embed_player.swf" flashvars="channel='.$attributes['channel'];if(isset($attributes['archive_id']))$html.='&amp;archive_id='.$attributes['archive_id'];if(isset($attributes['chapter_id']))$html.='&amp;chapter_id='.$attributes['chapter_id'];$html.='&amp;auto_play=false"></object>';}}elseif($qb===12){$attributes+=['cid'=>null];$html='<iframe width="480" height="302" allowfullscreen="" frameborder="0" scrolling="no" src="//www.ustream.tv/embed/';if(isset($attributes['vid']))$html.='recorded/'.$attributes['vid'];else$html.=$attributes['cid'];$html.='"></iframe>';}elseif($qb===13){$attributes+=['id'=>null];$html='<iframe width="512" height="288" src="http://live.wsj.com/public/page/embed-'.strtr($attributes['id'],'-','_').'.html" allowfullscreen="" frameborder="0" scrolling="no"></iframe>';}else{$attributes+=['id'=>null,'m'=>null,'s'=>null];$html='<iframe width="560" height="315" allowfullscreen="" frameborder="0" scrolling="no" src="//www.youtube.com/embed/'.$attributes['id'].'?controls=2';if(isset($attributes['list']))$html.='&amp;list='.$attributes['list'];if(isset($attributes['t'])||isset($attributes['m'])){$html.='&amp;start=';if(isset($attributes['t']))$html.=$attributes['t'];elseif(isset($attributes['h']))$html.=htmlspecialchars($attributes['h']*3600+$attributes['m']*60+$attributes['s'],2);else$html.=htmlspecialchars($attributes['m']*60+$attributes['s'],2);}$html.='"></iframe>';}

		return $html;
	}
}