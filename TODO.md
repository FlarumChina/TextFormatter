TODO
====

- finish the Fabric plugin
- create a plugin for the Markdown syntax (or possibly Upskirt/Redcarpet) and name it Downmark to feel witty and have a plugin for each letter from A to H
- write documentation, el oh el
- Add a rule to automatically create a parent to a tag, e.g. create <LIST> when <LI> is used. After creating <LIST>, add its id to the "require" field so that we don't get in an infinite loop position of the new tag should probably be the actual position of the tag, not of the whitespace
- JSParserGenerator: if all the plugins' RLA is the same, remove them from the config and use hints to bypass the if test
- Investigate the possibility of using an external CSS checker in order to enable a default "css" filter
- Consider a Twitter BBCode (https://dev.twitter.com/docs/embedded-tweets)
- Create a way for special XSL to be evaluated at the start/end of a rendering in order to embed resources such as external scripts
- Add a [TWITCH] BBCode. Add support for embeding TwitchTV/JustinTV videos AND live channels
- Add support for HD/other options in [YOUTUBE] ?
- Create BBCodesConfig::getBBCodeTemplate() that returns the definition of a BBCode, e.g. [URL={URL}]{TEXT}[/URL]
- Tags that have a nestingLimit of 1: is there any benefit to adding a denyChild rule to it?
- Add exception codes to exceptions?
- Possibly add an "hex" filter for /^[0-9a-f]+$/iD - what would be the return value though, string or integer? does "10" return 10 or 16 (0x10)
- BBCodesConfig::addBBCodeFromExample() - try to cast defaultValue to the right PHP type
- Replace PluginConfig::getXSL() with PluginConfig::getTemplates() which should return array([match]=>[template]) and each template goes through Templates::setTemplate() (how to evaluate attributes safety though)
- Look into properly implementing urlencode() and rawurlencode() in JS
- Way to implement syntax highlighting at parsing time: create tags in the "stx" namespace and implement syntax highlighting via... a plugin maybe? At least some stuff would need to be hardcoded, first of which would be the end [/CODE] tag, and probably also its start tag, [CODE]. Make the namespaced tags requireAncestor their CODE tag
- Add support for <ol start="2"/>
- Add a [FONT face={SIMPLETEXT}] bbcode/tag (could render to <span style="font-family:{SIMPLETEXT}">
- Implement the concept of a plugin "tag formatter": give it a tag from the intermediate form and it returns the string that could have generated it. e.g. BBCodes's tag formatter takes <URL url="..."> and returns [URL url="..."] or [URL="..."] -- tag content might be a problem though. Can we format any start/end tag without knowing what's in between?
- Add a Picasa(?) BBCode
- Read in #phpbb-dev: ""You cannot have 3 quotes within each other" I'm getting pretty annoyed by that one now >.<" "Has some kind of system that automatically removes the innermost quote been suggested? On large posts it's almost impossible to remove it by hand without messing the tags up :<" "Right now I just copy the text and paste it within [quote] because it's easier to see, but that kinda takes away the point with the quote button" -- could be implemented as a new setting: nestingLimitAction (similar to regexpLimitAction) with possible values "ignore" (leave as text), "strip" (remove content via <i> tag) and "abort" (throw exception?) -- Actually, this case is better handled at quoting time by removing the quotes from the original message directly, e.g. remove all //QUOTE//QUOTE//QUOTE nodes. Add a class that handles that kind of manipulation, e.g. removeNestedTags($tagName, $nestingLimit)
- Fix the path in "// Start of content generated by .." comments
- Sort the "isTransparent" situation wrt <video>. isTransparent makes a tag inherit the list of disallowed children from its parent, but it cannot currently allow tags that aren't allowed by its parent. In most cases, it doesn't matter, but it prevents using <track> as the child of <video> through the HTMLElements plugin
- Add a date/datetime filter, see http://dev.w3.org/html5/spec/Overview.html#valid-date-string-with-optional-time
- Add an NFO BBCode
- Consider providing compatilibity for custom Mycodes via the Generic plugin. http://docs.mybb.com/Admin_CP_Config_MyCode.html
- Consider allowing absolute paths in #url, e.g. "/foo.html"
- Consider a way to disallow HTML elements globally or at the tag-level. For example, a way to globally disable <a> so that BBCodes that produces links are disabled
- Consider guessing a value for quickMatch based on a plugin's regexp, using its fixed part if applicable [NOTE: gotta identify escape sequences such as \d and modifiers such as a+]
- Read in phpBB's forum 'maybe you put a threshold on errors -- if there are more than, say, 10, put out an error saying "Too many BBCode formatting errors found; fix the above and Preview the post again."' -- https://area51.phpbb.com/phpBB/viewtopic.php?f=108&t=33021&p=249335#p249335 -- NOTE: kind of sucks when those errors come from false positive from things like Autolink
- Read and consider https://github.com/Seldaek/fig-standards/blob/logger-interface/proposed/logger-interface.md
- JS parser needs quickMatch to be UTF-8
- Find a good way to test the JavaScript HTML plugins
- Look into ext/dom's XML_PARSE_HUGE -- apparently it's needed to render text with 1000s of tags
- Add some sort of optional filtering/escaping to the variables used in repositories? htmlspecialchars(), json_encode()
- Add a way to declare an attribute "safe in X", e.g. "safe in CSS" regardless of its filterChain to account for filters whose safety is unclear. Also try to determine whether a given regexp is safe: collect all the fixed parts (what about meta-characters and escape sequences?) plus the content of character classes (also negated classes) and make it a big character class then individually test whether it matches a list of forbidden characters
- Limit URLs length to whatever browsers grok
- Add some sort of TemplateHelper::loadHTML() to load HTML templates. XSL elements should be dropped or converted to HTML elements, and curly brackets in attributes should be escaped
- Exploitable? http://sla.ckers.org/forum/read.php?2,36997
- IDEA: when a tag is added, set a flag. Sort tags at beginning of processCurrentTag() if the flag is set. This way, a filter that adds a tag would force the tags to be re-sorted
- Add Filter::isSafeAsURL() to complement Filter::isSafeInURL() -- for example: <a href="http://foo.com/{IDENTIFIER}"/> and <a href="{IDENTIFIER}:{TEXT;postFilter=urlencode"/> -- {IDENTIFIER} is safe *in* URL, but not at the beginning ("javascript:alert%28%22k%22%29"), whereas {URL} is safe as URL
- Consider using preg_replace() to remove <st/>, <et/>, <i/> and any tag that is rendered by an empty template. Attention to predicates, a tag could have multiple templates -- doesn't seem to have any benefits on an average message
